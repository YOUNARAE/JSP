<%@page import="java.io.File"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
jpeg-red, png-green, gif-blue
<style type="text/css">
	.red{
		background-color:red;
	}
	.green{
		background-color:springgreen;
	}
	.blue{
		background-color:blue;
	}
</style>
<script type="text/javascript" src="<%=request.getContextPath() %>/resources/jquery-3.6.1.min.js"></script>
</head>
<body>
	<form action='<%=request.getContextPath() %>/imageStreaming.do'>
	<select name='image'> 
	</select>
	<input type='submit' value='전송' />
	</form>
	
	<script type="text/javascript">
	 const SELECTTAG = $("[name=image]"); // 자바로 치면 final. 상수로 만든다
	 // 선택하는 옵션에 해당 컬러클래스가 달라붙어야한다.
	 $.ajax({
	      dataType : "json",
	      success : function(resp) { //언마샬링이 끝나서 돌아온다
			console.log(resp.length);
	        let options = []; //비어있는 배열로 옵션을 만든다.옵션 텍스트 자체를 만드는 것이 아님
	      	$.each(resp, function(index, file){
	      		let option = $("<option>")
	      					.addClass(file.mime)
	      					.html(file.name); // 옵션태그가 1개 만들어짐
	      		options.push(option);
	      	});
	      	SELECTTAG.append(options);
		   	$("select[name=image]").on("change",function(){
				 console.log(this);
			});
	      },
	      error : function(jqXHR, status, error) {
	         console.log(jqXHR);
	         console.log(status);
	         console.log(error);
	      }
	   });
	</script>
</body>
</html>